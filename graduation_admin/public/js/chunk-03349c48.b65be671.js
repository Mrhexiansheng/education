(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-03349c48"],{"09ee":function(e,t,a){"use strict";var o=a("5a6a"),l=a.n(o);l.a},"0e33":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{separator:"/",width:"100%"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("管理员管理")]),a("el-breadcrumb-item",[e._v("资讯管理")])],1),a("el-divider"),a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"校内资讯信息",name:"first"}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-style":{"text-align":"center"},"cell-style":{"text-align":"center"}},on:{"cell-dblclick":e.tableDbEdit}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[a("el-form-item",{attrs:{label:"资讯描述"}},[a("span",[e._v(e._s(t.row.description))])]),a("el-form-item",{attrs:{label:"资讯申请时间"}},[a("span",[e._v(e._s(t.row.time))])]),a("el-form-item",{attrs:{label:"资讯图片"}},e._l(t.row.thumb,(function(t){return a("span",[a("el-link",{attrs:{target:"_blank",href:t.url,underline:!1,download:t.name}},[a("el-button",{attrs:{type:"text"}},[e._v(e._s(t.name))])],1),a("br")],1)})),0),a("el-form-item",{attrs:{label:"资讯材料"}},e._l(t.row.file,(function(t){return a("span",[a("el-link",{attrs:{target:"_blank",href:t.url,underline:!1,download:t.name}},[a("el-button",{attrs:{type:"text"}},[e._v(e._s(t.name))])],1),a("br")],1)})),0)],1)]}}])}),a("el-table-column",{attrs:{prop:"id",label:"id",width:"180"}}),a("el-table-column",{attrs:{prop:"title",label:"资讯名称",width:"180"}}),a("el-table-column",{attrs:{prop:"abroad",label:"资讯类型",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.abroad?a("el-button",{attrs:{type:"text"}},[e._v("校级")]):e._e(),2===t.row.abroad?a("el-button",{attrs:{type:"text"}},[e._v("院级")]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"college",label:"所属学院",width:"180"}}),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.del(t.row.id)}}},[e._v("删除")]),a("el-dialog",{attrs:{title:"信息编辑",visible:e.dialogVisible,width:"60%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-row",[a("el-col",[a("el-form",{ref:"editForm",attrs:{"label-width":"120px",model:e.editForm}},[a("el-form-item",{attrs:{label:"资讯类别",prop:"abroad"}},[a("el-radio",{attrs:{label:"1"},model:{value:e.editForm.abroad,callback:function(t){e.$set(e.editForm,"abroad",t)},expression:"editForm.abroad"}},[e._v("校级")]),a("el-radio",{attrs:{label:"2"},model:{value:e.editForm.abroad,callback:function(t){e.$set(e.editForm,"abroad",t)},expression:"editForm.abroad"}},[e._v("院级")])],1),2==e.editForm.abroad?a("el-form-item",{attrs:{label:"所属学院",prop:"college"}},[a("el-select",{attrs:{placeholder:"请选择所属学院"},model:{value:e.editForm.college,callback:function(t){e.$set(e.editForm,"college",t)},expression:"editForm.college"}},e._l(e.options,(function(e){return a("el-option",{key:e.id,attrs:{label:e.college,value:e.id}})})),1)],1):e._e(),a("el-form-item",{attrs:{label:"资讯简介",prop:"description"}},[a("el-input",{attrs:{placeholder:"请输入资讯简介",type:"textarea",rows:2},model:{value:e.editForm.description,callback:function(t){e.$set(e.editForm,"description",t)},expression:"editForm.description"}})],1),a("el-form-item",{attrs:{label:"资讯内容",prop:"content"}},[a("el-input",{attrs:{placeholder:"请输入资讯简介",type:"textarea",rows:2},model:{value:e.editForm.content,callback:function(t){e.$set(e.editForm,"content",t)},expression:"editForm.content"}})],1),a("el-form-item",{attrs:{label:"资讯图片",prop:"thumb"}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:e.upload,"on-remove":e.handleRemove,"on-success":e.handleAvatarSuccess1,"before-upload":e.beforePhoneUpload,"file-list":e.editForm.thumb,"list-type":"picture"}},[a("el-button",[e._v("点击上传(可选择上传)")])],1)],1),a("el-form-item",{attrs:{label:"资讯附属文件",prop:"file"}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:e.uploadFile,"on-remove":e.handleRemove1,"before-upload":e.beforeFileUpload,"on-success":e.handleFileSuccess,"file-list":e.editForm.file}},[a("el-button",[e._v("点击上传(可选择上传)")])],1)],1)],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("确 定")])],1)],1)]}}])})],1)],1)],1)],1),a("el-tab-pane",{attrs:{label:"校内资讯信息添加",name:"second"}},[a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.form,"status-icon":"",rules:e.rules,"label-width":"120px","hide-required-asterisk":!0,"status-icon":!0}},[a("el-form-item",{attrs:{label:"资讯名称",prop:"title"}},[a("el-input",{attrs:{type:"text"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),a("el-form-item",{attrs:{label:"资讯类别",prop:"abroad"}},[a("el-radio",{attrs:{label:"1"},model:{value:e.form.abroad,callback:function(t){e.$set(e.form,"abroad",t)},expression:"form.abroad"}},[e._v("校级")]),a("el-radio",{attrs:{label:"2"},model:{value:e.form.abroad,callback:function(t){e.$set(e.form,"abroad",t)},expression:"form.abroad"}},[e._v("院级")])],1),2==e.form.abroad?a("el-form-item",{attrs:{label:"所属学院",prop:"college"}},[a("el-select",{attrs:{placeholder:"请选择所属学院"},model:{value:e.form.college,callback:function(t){e.$set(e.form,"college",t)},expression:"form.college"}},e._l(e.options,(function(e){return a("el-option",{key:e.id,attrs:{label:e.college,value:e.id}})})),1)],1):e._e(),a("el-form-item",{attrs:{label:"资讯简介",prop:"description"}},[a("el-input",{attrs:{placeholder:"请输入资讯简介",type:"textarea",rows:2},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),a("el-form-item",{attrs:{label:"资讯内容",prop:"content"}},[a("el-input",{attrs:{placeholder:"请输入资讯简介",type:"textarea",rows:2},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),a("el-form-item",{attrs:{label:"资讯图片",prop:"thumb"}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:e.upload,"on-remove":e.handleRemove,"on-success":e.handleAvatarSuccess1,"before-upload":e.beforePhoneUpload,"file-list":e.form.thumb,"list-type":"picture"}},[a("el-button",[e._v("点击上传(可选择上传)")])],1)],1),a("el-form-item",{attrs:{label:"资讯附属文件",prop:"file"}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:e.uploadFile,"on-remove":e.handleRemove1,"before-upload":e.beforeFileUpload,"on-success":e.handleFileSuccess,"file-list":e.form.file}},[a("el-button",[e._v("点击上传(可选择上传)")])],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("添加")]),a("el-button",{on:{click:function(t){return e.reset()}}},[e._v("重置")])],1)],1)],1)],1)],1)],1)],1)},l=[],r=(a("6762"),a("7f7f"),a("ac6a"),{name:"SchoolInformation",data:function(){return{options:[],activeName:"first",uploadFile:this.$api.UPLOADFILE,upload:this.$api.UPLOAD,form:{title:"",file:[],thumb:[],description:"",content:"",time:(new Date).toLocaleString(),abroad:"",college:""},editForm:{},value:"",rules:{title:[{required:!0,message:"请输入资讯标题",trigger:"blur"}],content:[{required:!0,message:"请输入资讯内容",trigger:"blur"}],description:[{required:!0,message:"请输入资讯简介",trigger:"blur"}]},tableData:[],dialogVisible:!1}},methods:{handleClose:function(e){this.$confirm("确认关闭？").then((function(t){e()})).catch((function(e){}))},getData:function(){var e=this;this.$axios.get(this.$api.SCHOOLNEWS,{type:"ht"}).then((function(t){200===t.data.code?(t.data.data.forEach((function(e,t){e.file&&(e.file=JSON.parse(e.file)),e.thumb&&(e.thumb=JSON.parse(e.thumb))})),e.tableData=t.data.data):e.$message.error(t.data.msg)}))},handleRemove1:function(e){for(var t=0;t<this.form.file.length;t++)e.name===this.form.file[t].name&&this.form.file.splice(t,t+1)},handleRemove:function(e){for(var t=0;t<this.form.thumb.length;t++)e.name===this.form.thumb[t].name&&this.form.thumb.splice(t,t+1)},beforePhoneUpload:function(e){var t=["image/jpeg","image/jpg","image/png"],a=e.size/1024/1024<2;return t.includes(e.type)?a?void 0:(this.$message.error("上传头像图片大小不能超过 2MB!"),!1):(this.$message.error("上传的图片格式有误，请重新上传！"),!1)},beforeFileUpload:function(e){var t=["application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip"],a=e.size/1024/1024<5;return t.includes(e.type)?a?void 0:(this.$message.error("上传文件大小不能超过 5MB!"),!1):(this.$message.error("上传的文件格式有误，请重新上传！"),!1)},handleFileSuccess:function(e,t){if("error"===e)this.$message.error("上传失败");else{var a=t.name.lastIndexOf("."),o={};o.name=t.name.slice(0,a),o.url=e,this.form.file.push(o)}},handleAvatarSuccess1:function(e,t){if("error"===e)this.$message.error("上传失败");else{var a=t.name.lastIndexOf("."),o={};o.name=t.name.slice(0,a),o.url=e,this.form.thumb.push(o)}},handleClick:function(e,t){},reset:function(){this.$refs.ruleForm.resetFields(),this.form.abroads=""},add:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(!t)return!1;e.$confirm("是否选择添加该资讯?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.form.file&&(e.form.file=JSON.stringify(e.form.file)),e.form.thumb&&(e.form.thumb=JSON.stringify(e.form.thumb)),e.$axios.post(e.$api.SCHOOLNEWS,e.form).then((function(t){200===t.data.code?(e.$message.success(t.data.msg),e.reset(),e.getData()):(e.$message.error(t.data.msg),e.reset(),e.getData())}))})).catch((function(){e.$message({type:"info",message:"已取消添加"})}))}))},tableDbEdit:function(e,t,a,o){if("id"!=t.label&&"title"==t.property){o.target.innerHTML="";var l=document.createElement("input");l.setAttribute("type","text"),l.value=e.title,l.style.width="80%",l.style.height="80%",a.appendChild(l);var r=this;l.onblur=function(){a.removeChild(l),l.value!=e.title?(o.target.innerHTML=l.value,e.title=l.value,r.$axios.put(r.$api.SCHOOLNEWS,{type:"title",title:e.title,id:e.id}).then((function(e){200===e.data.code?(r.getData(),r.$message.success(e.data.msg)):r.$message.error(e.data.msg)}))):o.target.innerHTML=e.title}}},getCollege:function(){var e=this;this.$axios.get(this.$api.COLLEGE).then((function(t){200===t.data.code&&(e.options=t.data.data)}))},del:function(e){var t=this;this.$confirm("是否选择删除该信息?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$axios.delete(t.$api.SCHOOLNEWS,{id:e}).then((function(e){200===e.data.code?(t.$message.success(e.data.msg),t.getData()):(t.$message.error(e.data.msg),t.getData())}))})).catch((function(){t.$message({type:"info",message:"已取消添加"})}))},edit:function(e){var t=this;this.$axios.get(this.$api.SCHOOLNEWS,{id:e,edit:"edit"}).then((function(e){200===e.data.code?t.editForm=e.data.data:t.$message.error(e.data.msg)})),this.dialogVisible=!0}},mounted:function(){this.getData(),this.getCollege()}}),i=r,n=(a("09ee"),a("2877")),s=Object(n["a"])(i,o,l,!1,null,"278f8fb8",null);t["default"]=s.exports},"5a6a":function(e,t,a){},6762:function(e,t,a){"use strict";var o=a("5ca1"),l=a("c366")(!0);o(o.P,"Array",{includes:function(e){return l(this,e,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")("includes")}}]);
//# sourceMappingURL=chunk-03349c48.b65be671.js.map